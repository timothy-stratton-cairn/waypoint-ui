<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Demo User Profile</title>
	<meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
<div th:insert="~{header :: main}"></div>

<div class="container mt-4">
	<div class="row mb-3">

		<div class="col-md-12 note_card mb-3">
			<fieldset>
				<legend>User Information</legend>
				<form>
					<!-- Full Name and Email Row -->
					<div class="form-group row">
						<label class="col-md-2 col-form-label"><strong>Name:</strong></label>
						<div class="col-md-4">
							<span th:text="${user.firstName} + ' ' + ${user.lastName}">Full Name</span>
						</div>
						<label class="col-md-2 col-form-label"><strong>Email:</strong></label>
						<div class="col-md-4">
							<span th:text="${user.email}">Email Address</span>
						</div>
					</div>
				</form>
			</fieldset>
		</div>



		<!-- Active Protocols Card =-->
		<div class="col-md-12 note_card mb-3">
			<fieldset>
				<legend>Active Protocols</legend>
				<!-- Legend Row for column headers -->
				<div class="row font-weight-bold mb-2">
					<div class="col-md-2">Protocol</div>
					<div class="col-md-4">Description</div>
					<div class="col-md-4">Goal</div>
					<div class="col-md-2">Last Updated</div>
				</div>

				<!-- Protocols List -->
				<div class="list-group">
					<div class="list-group-item" th:each="protocol : ${userProtocols}">
						<div class="row">
							<div class="col-md-2">
								<span th:text="${protocol.name}">Protocol Name</span>
							</div>
							<div class="col-md-4">
								<span th:text="${protocol.description}">Protocol Description</span>
							</div>
							<div class="col-md-4">
								<span th:text="${protocol.goal != null ? protocol.goal : 'N/A'}">Goal</span>
							</div>
							<div class="col-md-2">
								<span th:text="${protocol.progress != null ? protocol.progress : 'N/A'}">Progress</span>
							</div>
						</div>
					</div>
				</div>
			</fieldset>
		</div>





		<!-- Homework Questions Card -->
		<div class="row note_card col-md-12 mb-3">
			<fieldset class="col-md-12">
				<legend>Homework Questions</legend>
				<ul class="nav nav-tabs" id="questionTabs" role="tablist">
					<li class="nav-item"><a class="nav-link active" href="#" onclick="loadQuestions(0)">All</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(1)">Personal</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(2)">Family</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(3)">Goals</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(4)">Insurance</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(5)">Investments</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(6)">Assets</a></li>
					<li class="nav-item"><a class="nav-link" href="#" onclick="loadQuestions(7)">Liabilities</a></li>
				</ul>

				<div id="stepsContent" class="mt-3">
					<ul class="list-group">
						<!-- Legend Row -->
						<li class="list-group-item bg-light font-weight-bold">
							<div class="row">
								<div class="col-md-6">Question</div>
								<div class="col-md-3">Response</div>
								<div class="col-md-2">Protocol</div>
								<div class="col-md-1">Last Updated</div>
							</div>
						</li>

						<!-- Dynamic Question Rows -->
						<li class="list-group-item question-item"
							th:each="questionResponse : ${Questions.questions}"
							th:data-category-id="${questionResponse.question.categoryId}">
							<div class="row">
								<div class="col-md-6">
									<strong th:text="${questionResponse.question.question}">Question Text</strong>
								</div>
								<div class="col-md-3">
									<span th:text="${questionResponse.response != null ? questionResponse.response.response : 'NEEDS ATTENTION'}">Response</span>
								</div>
								<div class="col-md-2">
									<span th:text="${questionResponse.protocol.name}">Protocol Name</span>
								</div>
								<div class="col-md-1">
									<span th:text="${questionResponse.question.updated != null ? questionResponse.question.updated : 'N/A'}">Last Updated</span>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</fieldset>
		</div>
	</div>
</div>

<div th:insert="~{footer :: main}"></div>

<script th:inline="javascript">
	function loadQuestions(categoryId) {
		$('.question-item').each(function() {
			const questionCategoryId = $(this).data('category-id');
			$(this).toggle(categoryId === 0 || questionCategoryId === categoryId);
		});
	}

	$(document).ready(function() {
		loadQuestions(0);
	});
</script>
</body>
</html>
